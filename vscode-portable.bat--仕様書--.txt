vscode-portable.bat　-仕様書-

[企画]
自分が使っているvscode-portableについて考えていたとき。
「user-data移すの知識いるし手間だし、自動化できれば便利だなあ」と思考。

[要件定義]
・先生にも見てほしいし、期間は２週間くらい？

・自作ソフトを既に作っているため、batchファイルのrobocopyを使って実現。

・必要なデータ(フォルダパスやUSBドライブなど)はコマンドプロンプトに聞かせる

[設計]

どうやって行うかを考える。

・構造
vscode-portable
	-実行batファイル
	-README.txt
	-vscode.zip(公式からダウンロード)
	-data.zip(import後に格納)

-自機PC-

・vscode-portableパッケージをUSBからCドライブへ

①ユーザーに情報を聞き、入力させる (どのユーザーでも実行できるように)

②Cドライブ上で必要なvscodeのdataを抽出し、圧縮

③圧縮したdataをUSBへ移動

-外出先PC-

・vscode-portableパッケージをUSBからCドライブへ

④vscode.zipのみを先に解凍

⑤vscode内でdata.zipを解凍


---ここからはメモとして---

[作業実行]

・必要なパスやドライブは、set /p の変数設定で、ユーザー定義の引数を変数に設定させる

・細かなcdは大切に。
[cd \(ルートディレクトリ)] [cd /D パス(ドライブをまたいだcd)] 

・ユーザー目線、余計なファイルが増えるのは煩わしい
→圧縮解凍ごみは必ず削除、また本パッケージ自体も削除できるようにアシストをつけてみる？？？

・いちいち２つの実行ファイル(import/export)を起動するのは煩わしい
importとexportの上位フォルダに統合版batを作成し、ユーザーの選択肢に応じて import/export を選択させる

・無効な選択肢をはじき、聞き直すプログラム
→「サブルーチン」の設定

[テスト]

vscode拡張機能 BatchRunner でvscode上でコマンドプロンプトを起動

[公開 / 感想]

やっていて思ったのは、機能とかコードを考えている時間が超楽しかったです。
誰かの喜ぶサービスを作っているんだなあ...って感じがしたり、純粋にコードが組みあがった時の算数問題が解けたみたいな感じがたまらなかったです。
しかし、デバッグの作業はかなり時間がかかったし、大変でした。
特に今回初めてサブルーチンなどの技術を使ったので、どこでエラーが起きているか、またコマンドプロンプト特有のエラー表示に頭を悩まされました。
これがもしフレームワークを実装したデスクトップアプリだと考えるとプログラミングエラー、アプリ上のエラー、ロジックエラーなど、多種多様なエラーと戦っていたんでしょう。


---

【バージョンアップ情報】

-A...メジャー変更
-B...マイナー変更
-C...パッチ変更

---
(1.1.1) 05/27にバージョンアップしました。
		-B ユーザーネーム変数を削除し、ユーザーの引数設定回数が減少
		-B 変数の引数を起動時すぐ設定されるように修正
		-C 条件分岐内容を修正
		-C 圧縮解凍の際の上書き機構を削除







[バージョンアップメモ]

(バージョンアップの予定)

〇7zipを用いて圧縮解凍を高速化

△exportのデスクトップショートカットのプログラム

〇exportのダウンロード後、vscode-portableをすぐに起動するプログラム

・ログの出力機能を用いて、ユーザー目線で何が起きたのかを分かりやすくする

・各コメントをもっと優しくする (２分ほどお待ちください / これよりダウンロードを開始します)

---

・vscode通常版のユーザーデータ(拡張機能)を移すバッチファイルも作成 まとめて
→どのPCでも同じ程度の環境構築が可能
→vscodeのバージョンが違う可能性があり、その場合は手動で拡張機能を再インストール　　

export時、パスの表示は追加で指示(アプリを右クリックして、ファイルの場所を開く)

---READMEに追加する予定

[2.vscode-translate.bat]
・このソフトは、自身のvscode環境を外出先PC(既にインストール済み)のvscodeに反映するソフトです。

-vscode-translateの場合-
    ・拡張機能が有効に使えない
    →ユーザー情報のコピーに不具合が生じているかもしれません。
    　vscodeの拡張機能を開くと、それぞれ適用させる画面が現れるので、実行しましょう。